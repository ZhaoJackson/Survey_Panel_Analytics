---
title: "Verasight Data Science Case Study - Complete Guide"
author: "Technical & Execution Manual"
date: "`r Sys.Date()`"
output: 
  html_notebook:
    toc: true
    toc_float: true
    theme: flatly
    highlight: tango
---

# 🎯 What This Project Is About

**Verasight Panel Analytics:** Complete data science solution analyzing survey panel quality, user behavior, and demographic patterns across 100+ annual projects.

**📱 MAIN DELIVERABLE: `app.R` - Interactive Shiny Dashboard**

**🔧 Technical Foundation:** R + tidyverse ecosystem with automated pipelines, multi-tier data architecture, and production-ready quality control systems.

---

# 🚀 Quick Start (30 seconds)

## Run the Complete Solution
```{r eval=FALSE}
# Launch the main dashboard (contains everything)
shiny::runApp("app.R")
```
**This gives you access to all 3 tasks in one interactive interface.**

---

# 📁 Project Architecture & Structure

## Complete File Organization

```
ds_case_study/
├── app.R                              # 🚀 Unified Shiny dashboard (main deliverable)
├── manual.Rmd                         # 📚 This guide (technical + execution)
├── data/                              # Original case study datasets
│   ├── users.rds                      # Panelist demographics & registration
│   ├── 2024-054_responses.rds         # Survey responses with weights
│   ├── 2024-054_reference.rds         # Question labels & metadata
│   └── full-response-db.rds           # Aggregated response database
└── tasks/                             # Individual task implementations
    ├── task1/                         # Demographic analysis engine
    │   ├── task1.Rmd                  # Analysis generator
    │   └── outputs/                   # 32 CSV files (8 questions × 4 demographics)
    ├── task2/                         # Response density analyzer  
    │   ├── task2.Rmd                  # Concentration calculator
    │   └── outputs/                   # Lorenz analysis & metrics
    └── task3/                         # Quality control pipeline
        ├── src/                       # Pipeline scripts
        │   ├── quality_control_pipeline.R    # Main processing engine
        │   ├── daily_pipeline.R              # Automated execution
        │   ├── daily_pipeline.sh             # Production scheduler
        │   └── RUN_PIPELINE.R               # One-click launcher
        ├── outputs/                   # Multi-level analysis results
        │   ├── qc_outputs/           # Quality control data
        │   ├── sample_survey/        # 110 generated projects
        │   └── verasight_quality_dashboard.html
        └── logs/                      # Execution & monitoring logs
```

## File Responsibilities

| File | Purpose | Technology | When to Use |
|------|---------|------------|-------------|
| **`app.R`** | 🏆 **MAIN DELIVERABLE** - Interactive dashboard | Shiny + plotly | **Always start here** |
| `tasks/task1/task1.Rmd` | Demographic analysis generator | R Markdown + for loops | Deep dive analysis |
| `tasks/task2/task2.Rmd` | Response density calculator | Lorenz curves + statistics | Statistical research |
| `tasks/task3/src/RUN_PIPELINE.R` | Quality control automation | Multi-tier pipeline | Production monitoring |

---

# 🔧 Technical Architecture

## Technology Stack

**Core Engine**: R + tidyverse ecosystem
**Dashboard**: Shiny + shinydashboard + plotly  
**Automation**: targets workflow + cron scheduling
**Data Processing**: dplyr + readr for ETL operations
**Visualization**: ggplot2 + plotly for interactive charts
**Documentation**: R Markdown for reproducible analysis

## Data Architecture

**Raw Layer**: Original RDS files with survey responses & demographics
**Processing Layer**: Standardized schemas with quality control fields
**Analysis Layer**: Multi-level aggregations (respondent/project/panel)
**Presentation Layer**: Interactive dashboards + downloadable results

## Technical Components

### Task 1: Demographic Analysis
- **Technology**: R Markdown + iteration tools (for loops)
- **Input**: Survey responses with demographic variables
- **Processing**: Weighted proportion calculations across demographic groups
- **Output**: 32 CSV files with interactive Shiny visualizations

### Task 2: Response Density Analysis
- **Technology**: Statistical concentration analysis (Lorenz curves)
- **Algorithm**: Cumulative distribution sorting with min(which()) threshold detection
- **Metrics**: User percentile calculations for response concentration
- **Visualization**: Interactive plotly charts with real-time filtering

### Task 3: Quality Control Pipeline
- **Architecture**: Multi-tier analysis (respondent → project → panel)
- **Processing**: Quality scoring with configurable weights
- **Automation**: Cron-based daily execution with comprehensive logging
- **Output**: Executive dashboards + monitoring alerts
- **Scalability**: Handles 100+ annual projects with data schema variations

## Quality Metrics Framework

**Attention Checks**: Binary failure flags
**Speeder Detection**: Fast completion indicators  
**Straight-lining**: Identical response pattern detection
**Composite Score**: `Q = 1 - (0.4×attention + 0.3×speeder + 0.3×straight_line)`

---

# 🔍 What Each Task Does

## Task 1: Demographics Analysis
**Question:** How do survey responses vary by demographics?
**Answer:** 32 automated tables showing weighted breakdowns by age, education, gender, race
**Key Output:** Interactive charts + CSV downloads
**Technology:** For loops with weighted proportion calculations

## Task 2: Response Density  
**Question:** What % of users drive most responses?
**Answer:** 15.68% of all users and 28.66% of recent users (90 days) account for 50% of their responses  
**Key Output:** Lorenz curves + concentration metrics
**Technology:** Statistical distribution analysis with plotly visualization

## Task 3: Quality Control Pipeline
**Question:** How to monitor survey quality at scale?
**Answer:** Automated daily pipeline analyzing 110 projects with quality scoring
**Key Output:** Executive dashboards + monitoring alerts
**Technology:** Multi-tier pipeline with cron automation

---

# ⚡ Execution Options

## Option 1: Interactive Dashboard (Recommended)
```{r eval=FALSE}
shiny::runApp("app.R")
```
- **Best for:** Presentations, exploration, stakeholders
- **Contains:** All 3 tasks in interactive format
- **Technology:** Unified Shiny interface with real-time updates
- **Output:** Real-time charts, tables, downloads

## Option 2: Individual Task Analysis
```{r eval=FALSE}
# Task 1: Generate demographic tables
rmarkdown::render("tasks/task1/task1.Rmd")

# Task 2: Calculate density metrics  
rmarkdown::render("tasks/task2/task2.Rmd")

# Task 3: Run quality pipeline
source("tasks/task3/src/RUN_PIPELINE.R")
```
- **Best for:** Research, detailed analysis, automation
- **Technology:** R Markdown for reproducible analysis
- **Output:** HTML reports, CSV files, dashboards

## Option 3: Production Quality Monitoring
```{r eval=FALSE}
# Set up automated daily monitoring
source("tasks/task3/src/RUN_PIPELINE.R")
```
- **Best for:** Operations teams, ongoing monitoring
- **Technology:** Automated cron scheduling with logging
- **Output:** Quality dashboards, alerts, trend analysis

---

# 📊 Key Results Summary

## Task 1 Results
- **32 CSV files** with weighted demographic breakdowns
- **8 survey questions** × **4 demographics** = complete analysis
- **Interactive charts** for all combinations
- **Technology:** Efficient for-loop processing with weighted calculations

## Task 2 Results  
- **15.68%** of all users → **50%** of responses
- **28.66%** of recent users → **50%** of responses  
- **Lorenz curves** showing concentration patterns
- **Technology:** Statistical concentration analysis with power-law detection

## Task 3 Results
- **110 survey projects** analyzed automatically
- **69,687 respondents** processed with quality scores
- **Daily monitoring** with executive dashboards
- **3-tier analysis:** Respondent → Project → Panel levels
- **Technology:** Production-ready pipeline with comprehensive logging

## Overall Implementation
- **Demographic Analysis**: 32 automated proportion tables
- **Density Concentration**: 15.68% of users → 50% of responses
- **Quality Pipeline**: 110 projects, 69,687 respondents processed
- **Dashboard Integration**: All tasks unified in single Shiny interface

---

# 🛠️ Prerequisites & Setup

## Required R Packages
```{r eval=FALSE}
install.packages(c(
  # Core dashboard
  "shiny", "shinydashboard", "dplyr", "ggplot2", "plotly",
  "readr", "tidyr", "DT", "rmarkdown",
  # Advanced features
  "lubridate", "scales", "jsonlite", "forcats", 
  "targets", "tarchetypes", "htmlwidgets"
))
```

## Data Files (Already Included)
- `data/users.rds` - User demographics & registration data
- `data/2024-054_responses.rds` - Survey responses with weights
- `data/2024-054_reference.rds` - Question labels & metadata
- `data/full-response-db.rds` - Complete response database

## Development Philosophy

**Modular Design**: Each task operates independently with clear interfaces
**Production Ready**: Automated pipelines with error handling & logging
**Scalable Architecture**: Handles growing data volumes without redesign
**User Focused**: Multiple interfaces for different user personas

---

# 🎯 Decision Tree: Which Option to Choose?

## For Stakeholders & Presentations
👉 **Use `app.R`** - Interactive dashboard with everything

## For Data Scientists & Researchers  
👉 **Use individual task `.Rmd` files** - Detailed analysis

## For Operations & Monitoring
👉 **Use `tasks/task3/src/RUN_PIPELINE.R`** - Automated quality control

## For Everything
👉 **Start with `app.R`** then explore individual components

---

# 🚨 Troubleshooting (Common Issues)

## Shiny App Won't Start
```{r eval=FALSE}
# Check data files exist
file.exists("data/users.rds")  # Should be TRUE

# Install missing packages
install.packages("shiny")

# Check working directory
getwd()  # Should end with "ds_case_study"
```

## Task 3 Pipeline Issues
```{r eval=FALSE}
# Run the launcher script (handles all setup)
source("tasks/task3/src/RUN_PIPELINE.R")

# Check outputs were generated
list.files("tasks/task3/outputs", recursive = TRUE)
```

## Missing Outputs
```{r eval=FALSE}
# Regenerate all outputs
rmarkdown::render("tasks/task1/task1.Rmd")
rmarkdown::render("tasks/task2/task2.Rmd") 
source("tasks/task3/src/RUN_PIPELINE.R")
```

---

# 📈 Success Metrics

**You'll know it's working when:**

✅ **Shiny app launches** with 4 tabs (Task 1, Task 2, Task 3, Summary)  
✅ **Task 1 shows** demographic charts and downloadable tables  
✅ **Task 2 displays** "15.68% of users account for 50% of responses"  
✅ **Task 3 presents** quality control dashboard with 110 projects  

---

# 🎯 Final Notes

- **`app.R` is your main deliverable** - everything else supports it
- **Start there** for immediate results and stakeholder demos  
- **Individual tasks** provide deeper analysis when needed
- **Task 3 automation** enables production monitoring
- **Modular architecture** allows independent development and scaling
- **Production-ready design** with comprehensive error handling

**🚀 Ready to start? Run: `shiny::runApp("app.R")`**

---

*Complete in 30 seconds. Comprehensive for months of analysis. Enterprise-ready architecture.*